#!/bin/bash
# $1 = app name
# $2 = app URL

name="$1"
url="$2"

# Lowercase filename for desktop file
fname=$(echo "$name" | tr '[:upper:]' '[:lower:]')
desktop_file="$HOME/.local/share/applications/$fname.desktop"


# Create .desktop file
cat > "$desktop_file" <<EOL
[Desktop Entry]
Version=1.0
Name=$name
Comment=$name Web App
Exec=brave --app="$url"
Icon=$name
Terminal=false
Type=Application
Categories=Network;Utility;
StartupWMClass=$name
EOL

# Download icon if it doesn't exist
icon_file="$HOME/.local/share/icons/$name.png"
if [ ! -f "$icon_file" ]; then
    wget -q -O "$icon_file" "https://www.google.com/s2/favicons?domain=$url&sz=256"
fi
